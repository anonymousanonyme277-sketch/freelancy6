<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Freelancy Online MVP</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
  
  /* --- Ø£Ù„ÙˆØ§Ù† Maron + Ø£Ø¨ÙŠØ¶ --- */
  body { font-family: 'Cairo', sans-serif; margin:0; background:#f5f0e6; min-height:100vh; }
  header { background:#8B4513; color:white; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
  header h1 { margin:0; font-size:1.8rem; }
  nav a { color:white; margin-left:1.2rem; text-decoration:none; font-weight:bold; cursor:pointer; transition:0.3s; }
  nav a:hover { color:#f5f0e6; text-decoration:underline; }
  
  .container { max-width:1000px; margin:2rem auto; background:white; padding:2rem; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.2);}
  h2 { color:#333; margin-bottom:1rem; }
  
  input, textarea { width:100%; padding:0.6rem; margin:0.5rem 0 1rem; border-radius:8px; border:1px solid #ccc; font-size:1rem; }
  
  button { background:#8B4513; color:white; border:none; padding:0.6rem 1.2rem; cursor:pointer; border-radius:8px; font-weight:bold; transition:0.3s; }
  button:hover { background:#5a2d0c; transform:scale(1.05);}
  
  .hidden { display:none; }
  .card { border-radius:10px; padding:1rem; margin-bottom:1rem; background:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.1); transition:0.3s;}
  .card:hover { box-shadow:0 8px 20px rgba(0,0,0,0.2); transform:translateY(-2px);}
  .profile-card { background:#f0e6de; }
  .messages-container { max-height:300px; overflow-y:auto; margin-bottom:1rem;}
</style>
</head>
<body>

<header>
  <h1>Freelancy</h1>
  <nav>
    <a onclick="showSection('loginSection')">Login/Signup</a>
    <a onclick="showSection('projectsSection')">Projects</a>
    <a onclick="showSection('profileSection')">My Profile</a>
    <a onclick="showSection('messagesSection')">Messages</a>
  </nav>
</header>

<!-- Login/Signup -->
<div class="container" id="loginSection">
  <h2>Login / Signup</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button onclick="signup()">Signup</button>
  <button onclick="login()">Login</button>
</div>

<!-- Projects -->
<div class="container hidden" id="projectsSection">
  <h2>Open Projects</h2>
  <div id="projectList"></div>
  <h2>Post a New Project</h2>
  <input type="text" id="title" placeholder="Project Title">
  <textarea id="description" placeholder="Project Description"></textarea>
  <button onclick="addProject()">Post Project</button>
</div>

<!-- Profile -->
<div class="container hidden" id="profileSection">
  <h2>My Profile</h2>
  <input type="text" id="skills" placeholder="Skills (comma separated)">
  <textarea id="bio" placeholder="Short Bio"></textarea>
  <button onclick="updateProfile()">Update Profile</button>
  <div id="profileInfo"></div>
</div>

<!-- Messages -->
<div class="container hidden" id="messagesSection">
  <h2>Messages</h2>
  <div class="messages-container" id="messageList"></div>
  <input type="text" id="messageInput" placeholder="Type your message...">
  <button onclick="sendMessage()">Send</button>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  // ðŸ”¹ Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø¹Ù„Ù‰ Firebase
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  let currentUser = null;

  function showSection(sectionId){
    document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
    document.getElementById(sectionId).classList.remove('hidden');
    if(sectionId==='profileSection') renderProfile();
    if(sectionId==='projectsSection') renderProjects();
    if(sectionId==='messagesSection') renderMessages();
  }

  // ----- Auth -----
  function signup(){
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    if(!email || !password){ alert("Fill all fields!"); return; }
    auth.createUserWithEmailAndPassword(email,password)
      .then(userCredential => {
        currentUser = userCredential.user;
        db.collection("users").doc(currentUser.uid).set({skills:'',bio:'',email:email});
        alert("Signup successful!");
        showSection('projectsSection');
      })
      .catch(err => alert(err.message));
  }

  function login(){
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    auth.signInWithEmailAndPassword(email,password)
      .then(userCredential => {
        currentUser = userCredential.user;
        alert("Logged in as "+email);
        showSection('projectsSection');
      })
      .catch(err => alert(err.message));
  }

  // ----- Projects -----
  function addProject(){
    if(!currentUser){ alert("Login first!"); return; }
    const title = document.getElementById('title').value.trim();
    const desc = document.getElementById('description').value.trim();
    if(!title||!desc){ alert("Fill all fields!"); return; }
    db.collection("projects").add({
      title, desc, author: currentUser.uid, applicants: []
    }).then(()=>{ renderProjects(); });
  }

  function renderProjects(){
    const projectList = document.getElementById('projectList');
    projectList.innerHTML='';
    db.collection("projects").orderBy("title").get().then(snapshot=>{
      snapshot.forEach(doc=>{
        const p = doc.data();
        const div = document.createElement('div');
        div.className='card project';
        div.innerHTML=`<h3>${p.title}</h3><p>${p.desc}</p><strong>Author:</strong> ${p.author}<br>
          <button onclick="applyProject('${doc.id}',this)">Apply</button>`;
        projectList.appendChild(div);
      });
    });
  }

  function applyProject(projectId,btn){
    if(!currentUser){ alert("Login first!"); return; }
    const projRef = db.collection("projects").doc(projectId);
    projRef.get().then(doc=>{
      let applicants = doc.data().applicants;
      if(applicants.includes(currentUser.uid)){ alert("Already applied!"); return; }
      applicants.push(currentUser.uid);
      projRef.update({applicants});
      btn.textContent="Applied!";
      btn.disabled=true;
      btn.style.background="#4caf50";
    });
  }

  // ----- Profile -----
  function updateProfile(){
    if(!currentUser){ alert("Login first!"); return; }
    const skills = document.getElementById('skills').value.trim();
    const bio = document.getElementById('bio').value.trim();
    db.collection("users").doc(currentUser.uid).update({skills,bio})
      .then(()=> renderProfile());
  }

  function renderProfile(){
    if(!currentUser) return;
    db.collection("users").doc(currentUser.uid).get().then(doc=>{
      const p = doc.data();
      const infoDiv = document.getElementById('profileInfo');
      infoDiv.innerHTML=`<div class="card profile-card"><strong>Skills:</strong> ${p.skills}<br><strong>Bio:</strong> ${p.bio}</div>`;
    });
  }

  // ----- Messages -----
  function sendMessage(){
    if(!currentUser){ alert("Login first!"); return; }
    const msg = document.getElementById('messageInput').value.trim();
    if(!msg) return;
    db.collection("messages").add({
      from: currentUser.uid,
      text: msg,
      time: new Date().toLocaleTimeString()
    }).then(()=> { document.getElementById('messageInput').value=''; renderMessages(); });
  }

  function renderMessages(){
    const list = document.getElementById('messageList');
    list.innerHTML='';
    db.collection("messages").orderBy("time").get().then(snapshot=>{
      snapshot.forEach(doc=>{
        const m = doc.data();
        const div = document.createElement('div');
        div.className='card message';
        div.innerHTML=`<strong>${m.from}:</strong> ${m.text} <em style="float:right">${m.time}</em>`;
        list.appendChild(div);
      });
    });
  }
</script>
</body>
</html>
